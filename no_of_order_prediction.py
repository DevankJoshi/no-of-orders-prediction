# -*- coding: utf-8 -*-
"""NO_OF_ORDER_PREDICTION.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1kw1V8iIogDLtT_J9IUG1fsYSWOpQ70l6
"""

import pandas as pd
import numpy as np
data = pd.read_csv("./supplement.csv")
data.head()

data.info()

data.isnull().sum()

data.describe()

import plotly.express as px

pie = data["Store_Type"].value_counts()
store = pie.index
orders = pie.values

fig = px.pie(data, values=orders, names=store)
fig.show()

pie2 = data["Location_Type"].value_counts()
location = pie2.index
orders = pie2.values

fig = px.pie(data, values=orders, names=location)
fig.show()

pie3 = data["Discount"].value_counts()
discount = pie3.index
orders = pie3.values

fig = px.pie(data, values=orders, names=discount)
fig.show()

pie4 = data["Holiday"].value_counts()
holiday = pie4.index
orders = pie4.values

fig = px.pie(data, values=orders, names=holiday)
fig.show()

data["Discount"] = data["Discount"].map({"No": 0, "Yes": 1})

data

data["Store_Type"] = data["Store_Type"].map({"S1": 1, "S2": 2, "S3": 3, "S4": 4})

data

data["Location_Type"] = data["Location_Type"].map({"L1": 1, "L2": 2, "L3": 3, "L4": 4, "L5": 5})

data

x = np.array(data[["Store_Type", "Location_Type", "Holiday", "Discount"]])
y = np.array(data["#Order"])

x

y

from sklearn.model_selection import train_test_split

xtrain, xtest, ytrain, ytest = train_test_split(x,y, test_size=0.2,random_state=42)

len(xtrain), len(xtest), len(ytrain), len(ytest), len(data)

import lightgbm as ltb
model = ltb.LGBMRegressor()

model.fit(xtrain, ytrain)

ypred = model.predict(xtest)

ypred,ytest

data = pd.DataFrame(data={"Predicted Orders": ypred.flatten()})
print(data.head())

model.score(xtest,ytest)



